syntax = "proto3";

package coupon;

service CouponStreamService {

  rpc StreamCouponIssues(StatusFilter) returns (stream CouponIssue);


  rpc StreamExpiredCoupons(ExpiredCouponFilter) returns (stream ExpiredCouponIssue);

  rpc StreamMoreCouponRequests(UserFilter) returns (stream MoreCouponRequest);

  rpc GetCouponsByStatus(CouponStatusFilter) returns (stream UserCoupon);



}


message StatusFilter {
  // List of statuses to filter, e.g., 'active', 'suspended', 'ended'
  repeated string statuses = 1; 
}



message CouponIssue {
  string id = 1;           
  string status = 2;       
  int64 updatedAt = 3; 
}


message ExpiredCouponFilter {
  string userId = 1;
  repeated string statuses = 2; 


}


message ExpiredCouponIssue {
  string id = 1;            
  int64 expireAt = 2;
  string code = 3;          
  string status = 4;
}

message UserFilter {
  string userId = 1;
}

message MoreCouponRequest {
  string id = 1;           
  string userId = 2;       
  string couponIssueId = 3; 
  int64 createdAt = 4;      
  string parentId = 5;   
}


message CouponStatusFilter {
  string userId = 1;          
  string status = 2;          
}


message UserCoupon {
  string id = 1;           
  string code = 2;         
  string status = 3;       
  int64 expireAt = 4;      
  int64 purchasedAt = 5;   
  int64 redeemedAt = 6;    
  string purchaseCurrency = 7; 
  int32 purchasePrice = 8; 
  string userId = 9;       
  string businessId = 10;  
  bool redeemedBySelfActivation = 11; 
}